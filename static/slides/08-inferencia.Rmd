---
title: "Métodos Computacionais para Análise de Risco"
author: 'Prof.: Thais Paiva'

date: "09 de abril de 2018"
subtitle: "08 - Inferência"

output:
  ioslides_presentation:
    css: my.css
    highlight: pygments
    logo: img/logo_ufmg.png
    widescreen: true
    self_contained: false
    lib_dir: libs
  beamer_presentation:
    highlight: pygments

header-includes: \usepackage{amsmath, amsbsy}
---

```{r echo=FALSE, warning=FALSE, purl=FALSE}
library(knitr)
```

```{r echo=FALSE}
## EST171 - Métodos Computacionais para Análise de Risco
## Código da aula 08 - Inferência

```

```{r echo=FALSE, purl=FALSE}
file_name = "08-inferencia"
```




## Aula de Hoje

- Revisão de Inferência


# Inferência Paramétrica


## Inferência Paramétrica

- O que é inferência paramétrica?

  + Estimar um **parâmetro** desconhecido de uma <span class="red3">*determinada distribuição*</span>.
  

- O analista assume que $(x_1,...,x_n)$ são realizações de uma amostra aleatória $(X_1,...,X_n)$, tal que $X_i$ são variáveis aleatórias independentes com essa <span class="red3">*distribuição*</span>.

$$X \sim F(.; \boldsymbol \theta) $$

## Inferência Paramétrica

- Por exemplo, vamos considerar a <span class="red3">**distribuição exponencial**</span>.

$$F(x; \theta) = (1 - e^{-\theta x}) \,\mathbb{1}_{\mathbb{R}_+}(x) $$
para $\theta \in \mathbb{R}_+$.

- Nosso objetivo é encontrar um **estimador** $\hat{\boldsymbol \theta}$ para $\boldsymbol \theta$.

- Depois de encontrar um estimador, o analista pode obter suas medidas de interesse (média, variância, quantis, probabilidade de sobrevivência, etc.) a partir da distribuição estimada $F(x; \hat{\boldsymbol \theta})$.


# Estimador de Máxima Verossimilhança


## Estimador de Máxima Verossimilhança

- Como o nome sugere, o EMV é o estimador que maximiza a **verossimilhança** com relação a $\boldsymbol \theta$:

$$\mathcal{L}(\boldsymbol \theta, x_1, \dots, x_n) = \prod_{i=1}^n f_X(x_i; \boldsymbol \theta) $$

- É mais conveniente maximizar a **log-verossimilhança** com relação a $\boldsymbol \theta$.

- Para algumas distribuições, conseguimos encontrar uma forma fechada para o EMV. Caso isso não seja possível, podemos utilizar *otimização númerica* para maximizar a log-verossimilhança.

- No R, o pacote `fitdistrplus` tem funções implementadas para encontrar o EMV de várias distribuições.

```{r echo=FALSE, message=FALSE}
## Pacotes
# install.packages("fitdistrplus")  # instalar esse primeiro
# install.packages("CASdatasets", repos = "http://cas.uqam.ca/pub/R/", type="source")
require(CASdatasets)
require(fitdistrplus)

```


## <span class="green3">**Exemplo - EMV**</span>

- Dados de indenizações > €500 de seguros automobilísticos contra terceiros na Itália desde 1997.

*(Para instalar o pacote CASdatasets: <http://cas.uqam.ca/>)*

```{r}
## dados seguro contra terceiros Itália
data("itamtplcost")

x = itamtplcost$UltimateCost/10^6
summary(x)
```


## <span class="green3">**Exemplo - EMV**</span>

- Vamos ajustar uma <span class="red3">**distribuição Gama**</span>.

```{r}
## EMV
fgamEMV = fitdist(x, "gamma", method="mle")
fgamEMV

```


## <span class="green3">**Exemplo - EMV**</span>

```{r}
summary(fgamEMV)

```


## <span class="green3">**Exemplo - EMV**</span>

```{r fig.align='center', fig.width=9}
plot(fgamEMV)

```



[//]: # ##########################################################
[//]: # Para gerar arquivo com apenas os comandos do R desta aula
```{r include=FALSE, purl=FALSE}
# gerar arquivo com comandos do R
purl(input=paste0(file_name,".Rmd"),
     output=paste0("../labs/",file_name,".R"),
     documentation=0, encoding='UTF-8')
# Saída: 'filename.R' com apenas o código extraído do arquivo original
# Opções: documentation=1 inclui o texto no título dos chunks
# Para excluir um chunk do arquivo final, incluir a opção purl=FALSE no cabeçalho do chunk
```




